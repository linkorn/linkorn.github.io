!function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="/",t(0)}([function(e,t,o){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function r(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function l(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}o(1).polyfill(),document.querySelector(".scroll").addEventListener("click",function(e){e.preventDefault();var t=document.querySelector(e.currentTarget.getAttribute("href"));t.scrollIntoView({behavior:"smooth"})});var c=["development","outsourcing","consalting","testing","automation"],i=c.reduce(function(e,t){return e[""+t]=document.querySelector("."+t+" video"),e},{});c.map(function(e){var t=document.querySelector("."+e);t.addEventListener("mouseover",function(){i[""+e].play()}),t.addEventListener("mouseout",function(){i[""+e].pause()});try{i[""+e].play(),setTimeout(function(){return i[""+e].pause()},1e3)}catch(e){}});var a=document.forms[0];[].concat(n(a.querySelectorAll(".fi"))).map(function(e){e.value="",l(e,"has-text"),e.addEventListener("change",function(e){var t=e.currentTarget;""===t.value?l(t,"has-text"):r(t,"has-text")})});var s=null,u=document.getElementById("m-nav");if(document.querySelector(".navigation-button").addEventListener("click",function(e){e.preventDefault(),s||(s=document.querySelector("nav ul"),u.appendChild(s.cloneNode(!0))),r(document.body,"mobile-menu")}),document.getElementById("close-m-nav").addEventListener("click",function(e){e.preventDefault(),l(document.body,"mobile-menu")}),window.Promise){var f=new FormData(a);f.append("ajax","true"),a.addEventListener("submit",function(e){e.preventDefault(),r(a,"blocked"),fetch(a.action,{}).then(function(e){r(a,"sended");var t=document.createElement("div");r(t,"send-ok"),t.innerHTML='Спасибо! Мы вам скоро перезвоним.<br>Еще вы можете написать нам на <a href="mailto:info@linkorn.ru">info@linkorn.ru</a>',a.appendChild(t),document.querySelector(".send-ok").focus()}).catch(l(a,"blocked"))})}},function(e,t,o){!function(t,o,n){"use strict";function r(){function e(e,t){this.scrollLeft=e,this.scrollTop=t}function r(e){return.5*(1-Math.cos(Math.PI*e))}function l(e){if("object"!=typeof e||null===e||e.behavior===n||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior not valid")}function c(e){var n,r,l;do e=e.parentNode,n=e===o.body,r=e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth,l="visible"===t.getComputedStyle(e,null).overflow;while(!n&&(!r||l));return n=r=l=null,e}function i(e){e.frame=t.requestAnimationFrame(i.bind(t,e));var o,n,l,c=d(),a=(c-e.startTime)/u;if(a=a>1?1:a,o=r(a),n=e.startX+(e.x-e.startX)*o,l=e.startY+(e.y-e.startY)*o,e.method.call(e.scrollable,n,l),n===e.x&&l===e.y)return void t.cancelAnimationFrame(e.frame)}function a(n,r,l){var c,a,s,u,m,p=d();n===o.body?(c=t,a=t.scrollX||t.pageXOffset,s=t.scrollY||t.pageYOffset,u=f.scroll):(c=n,a=n.scrollLeft,s=n.scrollTop,u=e),m&&t.cancelAnimationFrame(m),i({scrollable:c,method:u,startTime:p,startX:a,startY:s,x:r,y:l,frame:m})}if(!("scrollBehavior"in o.documentElement.style)){var s=t.HTMLElement||t.Element,u=468,f={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,scrollIntoView:s.prototype.scrollIntoView},d=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now;t.scroll=t.scrollTo=function(){return l(arguments[0])?void f.scroll.call(t,arguments[0].left||arguments[0],arguments[0].top||arguments[1]):void a.call(t,o.body,~~arguments[0].left,~~arguments[0].top)},t.scrollBy=function(){return l(arguments[0])?void f.scrollBy.call(t,arguments[0].left||arguments[0],arguments[0].top||arguments[1]):void a.call(t,o.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))},s.prototype.scrollIntoView=function(){if(l(arguments[0]))return void f.scrollIntoView.call(this,arguments[0]||!0);var e=c(this),n=e.getBoundingClientRect(),r=this.getBoundingClientRect();e!==o.body?(a.call(this,e,e.scrollLeft+r.left-n.left,e.scrollTop+r.top-n.top),t.scrollBy({left:n.left,top:n.top,behavior:"smooth"})):t.scrollBy({left:r.left,top:r.top,behavior:"smooth"})}}}e.exports={polyfill:r}}(window,document)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbWFpbi5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMWM3ZGY0Njg1NjFiNDUzNWRkODciLCJ3ZWJwYWNrOi8vLy4vRjovcHJvamVjdHMvbGlua29ybjIwMTcvc3JjL2pzL21haW4uanMiLCJ3ZWJwYWNrOi8vLy4vfi9zbW9vdGhzY3JvbGwtcG9seWZpbGwvZGlzdC9zbW9vdGhzY3JvbGwuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5IiwiaSIsImFycjIiLCJsZW5ndGgiLCJmcm9tIiwiYWRkQ2xhc3MiLCJlbCIsImNsYXNzTmFtZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUNsYXNzIiwicmVtb3ZlIiwicmVwbGFjZSIsIlJlZ0V4cCIsInNwbGl0Iiwiam9pbiIsInBvbHlmaWxsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIiR0byIsImN1cnJlbnRUYXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwidmRzIiwiJHZpZGVvcyIsInJlZHVjZSIsIm1hcCIsIiRlbCIsInBsYXkiLCJwYXVzZSIsInNldFRpbWVvdXQiLCIkZm9ybSIsImZvcm1zIiwiY29uY2F0IiwicXVlcnlTZWxlY3RvckFsbCIsInZhbHVlIiwibWVudSIsIiRtX25hdiIsImdldEVsZW1lbnRCeUlkIiwiYXBwZW5kQ2hpbGQiLCJjbG9uZU5vZGUiLCJib2R5Iiwid2luZG93IiwiUHJvbWlzZSIsImRhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsImZldGNoIiwiYWN0aW9uIiwidGhlbiIsInJlc3BvbnNlIiwiJHNlbmRPayIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJmb2N1cyIsImNhdGNoIiwidyIsImQiLCJ1bmRlZmluZWQiLCJzY3JvbGxFbGVtZW50IiwieCIsInkiLCJ0aGlzIiwic2Nyb2xsTGVmdCIsInNjcm9sbFRvcCIsImVhc2UiLCJrIiwiTWF0aCIsImNvcyIsIlBJIiwic2hvdWxkQmFpbE91dCIsIlR5cGVFcnJvciIsImZpbmRTY3JvbGxhYmxlUGFyZW50IiwiaXNCb2R5IiwiaGFzU2Nyb2xsYWJsZVNwYWNlIiwiaGFzVmlzaWJsZU92ZXJmbG93IiwicGFyZW50Tm9kZSIsImNsaWVudEhlaWdodCIsInNjcm9sbEhlaWdodCIsImNsaWVudFdpZHRoIiwic2Nyb2xsV2lkdGgiLCJnZXRDb21wdXRlZFN0eWxlIiwib3ZlcmZsb3ciLCJzdGVwIiwiY29udGV4dCIsImZyYW1lIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsImN1cnJlbnRYIiwiY3VycmVudFkiLCJ0aW1lIiwibm93IiwiZWxhcHNlZCIsInN0YXJ0VGltZSIsIlNDUk9MTF9USU1FIiwic3RhcnRYIiwic3RhcnRZIiwibWV0aG9kIiwic2Nyb2xsYWJsZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwic21vb3RoU2Nyb2xsIiwic2Nyb2xsWCIsInBhZ2VYT2Zmc2V0Iiwic2Nyb2xsWSIsInBhZ2VZT2Zmc2V0Iiwib3JpZ2luYWwiLCJzY3JvbGwiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsIkVsZW1lbnQiLCJIVE1MRWxlbWVudCIsInNjcm9sbFRvIiwic2Nyb2xsQnkiLCJwcm90b3R5cGUiLCJwZXJmb3JtYW5jZSIsIkRhdGUiLCJhcmd1bWVudHMiLCJsZWZ0IiwidG9wIiwic2Nyb2xsYWJsZVBhcmVudCIsInBhcmVudFJlY3RzIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiY2xpZW50UmVjdHMiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0Es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Q0FoRyxTQUFBLGFBUUFwQyxFQUFBRCxTQUFzQjJCLGFBS3JCOEIsT0FBQTdCIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblx0XG5cdF9fd2VicGFja19yZXF1aXJlX18oMSkucG9seWZpbGwoKTtcblx0XG5cdC8vIHNtb290aCBzY3JvbGxpbmdcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjcm9sbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0ICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgIHZhciAkdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSk7XG5cdCAgICAkdG8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XG5cdH0pO1xuXHRcblx0Ly8gcGxheSB2aWRlb1xuXHR2YXIgdmRzID0gWydkZXZlbG9wbWVudCcsICdvdXRzb3VyY2luZycsICdjb25zYWx0aW5nJywgJ3Rlc3RpbmcnLCAnYXV0b21hdGlvbiddO1xuXHR2YXIgJHZpZGVvcyA9IHZkcy5yZWR1Y2UoZnVuY3Rpb24gKHAsIGkpIHtcblx0ICAgIHBbJycgKyBpXSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgaSArICcgdmlkZW8nKTtyZXR1cm4gcDtcblx0fSwge30pO1xuXHR2ZHMubWFwKGZ1bmN0aW9uIChlKSB7XG5cdCAgICB2YXIgJGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBlKTtcblx0ICAgICRlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgJHZpZGVvc1snJyArIGVdLnBsYXkoKTtcblx0ICAgIH0pO1xuXHRcblx0ICAgICRlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAkdmlkZW9zWycnICsgZV0ucGF1c2UoKTtcblx0ICAgIH0pO1xuXHQgICAgdHJ5IHtcblx0ICAgICAgICAkdmlkZW9zWycnICsgZV0ucGxheSgpO1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gJHZpZGVvc1snJyArIGVdLnBhdXNlKCk7XG5cdCAgICAgICAgfSwgMTAwMCk7XG5cdCAgICB9IGNhdGNoIChlKSB7fVxuXHR9KTtcblx0XG5cdC8vIGZvcm1cblx0dmFyICRmb3JtID0gZG9jdW1lbnQuZm9ybXNbMF07XG5cdFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoJGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmZpJykpKS5tYXAoZnVuY3Rpb24gKGkpIHtcblx0ICAgIGkudmFsdWUgPSBcIlwiO1xuXHQgICAgcmVtb3ZlQ2xhc3MoaSwgJ2hhcy10ZXh0Jyk7XG5cdCAgICBpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgdmFyICRlbCA9IGUuY3VycmVudFRhcmdldDtcblx0ICAgICAgICBpZiAoJGVsLnZhbHVlID09PSAnJykge1xuXHQgICAgICAgICAgICByZW1vdmVDbGFzcygkZWwsICdoYXMtdGV4dCcpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKCRlbCwgJ2hhcy10ZXh0Jyk7XG5cdCAgICAgICAgfVxuXHQgICAgfSk7XG5cdH0pO1xuXHRcblx0Ly8gbmF2aWdhdGlvbiBidXR0b25cblx0XG5cdHZhciBtZW51ID0gbnVsbDtcblx0dmFyICRtX25hdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtLW5hdicpO1xuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbi1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdCAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICBpZiAoIW1lbnUpIHtcblx0ICAgICAgICBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbmF2IHVsJyk7XG5cdCAgICAgICAgJG1fbmF2LmFwcGVuZENoaWxkKG1lbnUuY2xvbmVOb2RlKHRydWUpKTtcblx0ICAgIH1cblx0ICAgIGFkZENsYXNzKGRvY3VtZW50LmJvZHksIFwibW9iaWxlLW1lbnVcIik7XG5cdH0pO1xuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2UtbS1uYXYnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdCAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICByZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LCBcIm1vYmlsZS1tZW51XCIpO1xuXHR9KTtcblx0XG5cdGlmICh3aW5kb3cuUHJvbWlzZSkge1xuXHQgICAgdmFyIGRhdGEgPSBuZXcgRm9ybURhdGEoJGZvcm0pO1xuXHQgICAgZGF0YS5hcHBlbmQoJ2FqYXgnLCAndHJ1ZScpO1xuXHQgICAgJGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgYWRkQ2xhc3MoJGZvcm0sICdibG9ja2VkJyk7XG5cdCAgICAgICAgZmV0Y2goJGZvcm0uYWN0aW9uLCB7XG5cdCAgICAgICAgICAgIC8qbWV0aG9kOiAnUE9TVCcsXG5cdCAgICAgICAgICAgIGJvZHk6IGRhdGEqL1xuXHQgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKCRmb3JtLCAnc2VuZGVkJyk7XG5cdCAgICAgICAgICAgIHZhciAkc2VuZE9rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKCRzZW5kT2ssICdzZW5kLW9rJyk7XG5cdCAgICAgICAgICAgICRzZW5kT2suaW5uZXJIVE1MID0gJ9Ch0L/QsNGB0LjQsdC+ISDQnNGLINCy0LDQvCDRgdC60L7RgNC+INC/0LXRgNC10LfQstC+0L3QuNC8Ljxicj7QldGJ0LUg0LLRiyDQvNC+0LbQtdGC0LUg0L3QsNC/0LjRgdCw0YLRjCDQvdCw0Lwg0L3QsCA8YSBocmVmPVwibWFpbHRvOmluZm9AbGlua29ybi5ydVwiPmluZm9AbGlua29ybi5ydTwvYT4nO1xuXHQgICAgICAgICAgICAkZm9ybS5hcHBlbmRDaGlsZCgkc2VuZE9rKTtcblx0ICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbmQtb2snKS5mb2N1cygpO1xuXHQgICAgICAgIH0pLmNhdGNoKHJlbW92ZUNsYXNzKCRmb3JtLCAnYmxvY2tlZCcpKTtcblx0ICAgIH0pO1xuXHR9XG5cdFxuXHQvL2FkZCBjbGFzc1xuXHRmdW5jdGlvbiBhZGRDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG5cdCAgICBpZiAoZWwuY2xhc3NMaXN0KSBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7ZWxzZSBlbC5jbGFzc05hbWUgKz0gJyAnICsgY2xhc3NOYW1lO1xuXHR9XG5cdC8vIHJlbW92ZSBjbGFzc1xuXHRmdW5jdGlvbiByZW1vdmVDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG5cdFxuXHQgICAgaWYgKGVsLmNsYXNzTGlzdCkgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO2Vsc2UgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgnKF58XFxcXGIpJyArIGNsYXNzTmFtZS5zcGxpdCgnICcpLmpvaW4oJ3wnKSArICcoXFxcXGJ8JCknLCAnZ2knKSwgJyAnKTtcblx0fVxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0Lypcblx0ICogc21vb3Roc2Nyb2xsIHBvbHlmaWxsIC0gdjAuMy40XG5cdCAqIGh0dHBzOi8vaWFtZHVzdGFuLmdpdGh1Yi5pby9zbW9vdGhzY3JvbGxcblx0ICogMjAxNiAoYykgRHVzdGFuIEthc3RlbiwgSmVyZW1pYXMgTWVuaWNoZWxsaSAtIE1JVCBMaWNlbnNlXG5cdCAqL1xuXHRcblx0KGZ1bmN0aW9uKHcsIGQsIHVuZGVmaW5lZCkge1xuXHQgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgLypcblx0ICAgKiBhbGlhc2VzXG5cdCAgICogdzogd2luZG93IGdsb2JhbCBvYmplY3Rcblx0ICAgKiBkOiBkb2N1bWVudFxuXHQgICAqIHVuZGVmaW5lZDogdW5kZWZpbmVkXG5cdCAgICovXG5cdFxuXHQgIC8vIHBvbHlmaWxsXG5cdCAgZnVuY3Rpb24gcG9seWZpbGwoKSB7XG5cdCAgICAvLyByZXR1cm4gd2hlbiBzY3JvbGxCZWhhdmlvciBpbnRlcmZhY2UgaXMgc3VwcG9ydGVkXG5cdCAgICBpZiAoJ3Njcm9sbEJlaGF2aW9yJyBpbiBkLmRvY3VtZW50RWxlbWVudC5zdHlsZSkge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cdFxuXHQgICAgLypcblx0ICAgICAqIGdsb2JhbHNcblx0ICAgICAqL1xuXHQgICAgdmFyIEVsZW1lbnQgPSB3LkhUTUxFbGVtZW50IHx8IHcuRWxlbWVudDtcblx0ICAgIHZhciBTQ1JPTExfVElNRSA9IDQ2ODtcblx0XG5cdCAgICAvKlxuXHQgICAgICogb2JqZWN0IGdhdGhlcmluZyBvcmlnaW5hbCBzY3JvbGwgbWV0aG9kc1xuXHQgICAgICovXG5cdCAgICB2YXIgb3JpZ2luYWwgPSB7XG5cdCAgICAgIHNjcm9sbDogdy5zY3JvbGwgfHwgdy5zY3JvbGxUbyxcblx0ICAgICAgc2Nyb2xsQnk6IHcuc2Nyb2xsQnksXG5cdCAgICAgIHNjcm9sbEludG9WaWV3OiBFbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlld1xuXHQgICAgfTtcblx0XG5cdCAgICAvKlxuXHQgICAgICogZGVmaW5lIHRpbWluZyBtZXRob2Rcblx0ICAgICAqL1xuXHQgICAgdmFyIG5vdyA9IHcucGVyZm9ybWFuY2UgJiYgdy5wZXJmb3JtYW5jZS5ub3dcblx0ICAgICAgPyB3LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHcucGVyZm9ybWFuY2UpIDogRGF0ZS5ub3c7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBjaGFuZ2VzIHNjcm9sbCBwb3NpdGlvbiBpbnNpZGUgYW4gZWxlbWVudFxuXHQgICAgICogQG1ldGhvZCBzY3JvbGxFbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuXHQgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gc2Nyb2xsRWxlbWVudCh4LCB5KSB7XG5cdCAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHg7XG5cdCAgICAgIHRoaXMuc2Nyb2xsVG9wID0geTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIHJldHVybnMgcmVzdWx0IG9mIGFwcGx5aW5nIGVhc2UgbWF0aCBmdW5jdGlvbiB0byBhIG51bWJlclxuXHQgICAgICogQG1ldGhvZCBlYXNlXG5cdCAgICAgKiBAcGFyYW0ge051bWJlcn0ga1xuXHQgICAgICogQHJldHVybnMge051bWJlcn1cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gZWFzZShrKSB7XG5cdCAgICAgIHJldHVybiAwLjUgKiAoMSAtIE1hdGguY29zKE1hdGguUEkgKiBrKSk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBpbmRpY2F0ZXMgaWYgYSBzbW9vdGggYmVoYXZpb3Igc2hvdWxkIGJlIGFwcGxpZWRcblx0ICAgICAqIEBtZXRob2Qgc2hvdWxkQmFpbE91dFxuXHQgICAgICogQHBhcmFtIHtOdW1iZXJ8T2JqZWN0fSB4XG5cdCAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gc2hvdWxkQmFpbE91dCh4KSB7XG5cdCAgICAgIGlmICh0eXBlb2YgeCAhPT0gJ29iamVjdCdcblx0ICAgICAgICAgICAgfHwgeCA9PT0gbnVsbFxuXHQgICAgICAgICAgICB8fCB4LmJlaGF2aW9yID09PSB1bmRlZmluZWRcblx0ICAgICAgICAgICAgfHwgeC5iZWhhdmlvciA9PT0gJ2F1dG8nXG5cdCAgICAgICAgICAgIHx8IHguYmVoYXZpb3IgPT09ICdpbnN0YW50Jykge1xuXHQgICAgICAgIC8vIGZpcnN0IGFyZyBub3QgYW4gb2JqZWN0L251bGxcblx0ICAgICAgICAvLyBvciBiZWhhdmlvciBpcyBhdXRvLCBpbnN0YW50IG9yIHVuZGVmaW5lZFxuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAodHlwZW9mIHggPT09ICdvYmplY3QnXG5cdCAgICAgICAgICAgICYmIHguYmVoYXZpb3IgPT09ICdzbW9vdGgnKSB7XG5cdCAgICAgICAgLy8gZmlyc3QgYXJndW1lbnQgaXMgYW4gb2JqZWN0IGFuZCBiZWhhdmlvciBpcyBzbW9vdGhcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIHRocm93IGVycm9yIHdoZW4gYmVoYXZpb3IgaXMgbm90IHN1cHBvcnRlZFxuXHQgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdiZWhhdmlvciBub3QgdmFsaWQnKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIGZpbmRzIHNjcm9sbGFibGUgcGFyZW50IG9mIGFuIGVsZW1lbnRcblx0ICAgICAqIEBtZXRob2QgZmluZFNjcm9sbGFibGVQYXJlbnRcblx0ICAgICAqIEBwYXJhbSB7Tm9kZX0gZWxcblx0ICAgICAqIEByZXR1cm5zIHtOb2RlfSBlbFxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBmaW5kU2Nyb2xsYWJsZVBhcmVudChlbCkge1xuXHQgICAgICB2YXIgaXNCb2R5O1xuXHQgICAgICB2YXIgaGFzU2Nyb2xsYWJsZVNwYWNlO1xuXHQgICAgICB2YXIgaGFzVmlzaWJsZU92ZXJmbG93O1xuXHRcblx0ICAgICAgZG8ge1xuXHQgICAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcblx0XG5cdCAgICAgICAgLy8gc2V0IGNvbmRpdGlvbiB2YXJpYWJsZXNcblx0ICAgICAgICBpc0JvZHkgPSBlbCA9PT0gZC5ib2R5O1xuXHQgICAgICAgIGhhc1Njcm9sbGFibGVTcGFjZSA9XG5cdCAgICAgICAgICBlbC5jbGllbnRIZWlnaHQgPCBlbC5zY3JvbGxIZWlnaHQgfHxcblx0ICAgICAgICAgIGVsLmNsaWVudFdpZHRoIDwgZWwuc2Nyb2xsV2lkdGg7XG5cdCAgICAgICAgaGFzVmlzaWJsZU92ZXJmbG93ID1cblx0ICAgICAgICAgIHcuZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCkub3ZlcmZsb3cgPT09ICd2aXNpYmxlJztcblx0ICAgICAgfSB3aGlsZSAoIWlzQm9keSAmJiAhKGhhc1Njcm9sbGFibGVTcGFjZSAmJiAhaGFzVmlzaWJsZU92ZXJmbG93KSk7XG5cdFxuXHQgICAgICBpc0JvZHkgPSBoYXNTY3JvbGxhYmxlU3BhY2UgPSBoYXNWaXNpYmxlT3ZlcmZsb3cgPSBudWxsO1xuXHRcblx0ICAgICAgcmV0dXJuIGVsO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2VsZiBpbnZva2VkIGZ1bmN0aW9uIHRoYXQsIGdpdmVuIGEgY29udGV4dCwgc3RlcHMgdGhyb3VnaCBzY3JvbGxpbmdcblx0ICAgICAqIEBtZXRob2Qgc3RlcFxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHRcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gc3RlcChjb250ZXh0KSB7XG5cdCAgICAgIC8vIGNhbGwgbWV0aG9kIGFnYWluIG9uIG5leHQgYXZhaWxhYmxlIGZyYW1lXG5cdCAgICAgIGNvbnRleHQuZnJhbWUgPSB3LnJlcXVlc3RBbmltYXRpb25GcmFtZShzdGVwLmJpbmQodywgY29udGV4dCkpO1xuXHRcblx0ICAgICAgdmFyIHRpbWUgPSBub3coKTtcblx0ICAgICAgdmFyIHZhbHVlO1xuXHQgICAgICB2YXIgY3VycmVudFg7XG5cdCAgICAgIHZhciBjdXJyZW50WTtcblx0ICAgICAgdmFyIGVsYXBzZWQgPSAodGltZSAtIGNvbnRleHQuc3RhcnRUaW1lKSAvIFNDUk9MTF9USU1FO1xuXHRcblx0ICAgICAgLy8gYXZvaWQgZWxhcHNlZCB0aW1lcyBoaWdoZXIgdGhhbiBvbmVcblx0ICAgICAgZWxhcHNlZCA9IGVsYXBzZWQgPiAxID8gMSA6IGVsYXBzZWQ7XG5cdFxuXHQgICAgICAvLyBhcHBseSBlYXNpbmcgdG8gZWxhcHNlZCB0aW1lXG5cdCAgICAgIHZhbHVlID0gZWFzZShlbGFwc2VkKTtcblx0XG5cdCAgICAgIGN1cnJlbnRYID0gY29udGV4dC5zdGFydFggKyAoY29udGV4dC54IC0gY29udGV4dC5zdGFydFgpICogdmFsdWU7XG5cdCAgICAgIGN1cnJlbnRZID0gY29udGV4dC5zdGFydFkgKyAoY29udGV4dC55IC0gY29udGV4dC5zdGFydFkpICogdmFsdWU7XG5cdFxuXHQgICAgICBjb250ZXh0Lm1ldGhvZC5jYWxsKGNvbnRleHQuc2Nyb2xsYWJsZSwgY3VycmVudFgsIGN1cnJlbnRZKTtcblx0XG5cdCAgICAgIC8vIHJldHVybiB3aGVuIGVuZCBwb2ludHMgaGF2ZSBiZWVuIHJlYWNoZWRcblx0ICAgICAgaWYgKGN1cnJlbnRYID09PSBjb250ZXh0LnggJiYgY3VycmVudFkgPT09IGNvbnRleHQueSkge1xuXHQgICAgICAgIHcuY2FuY2VsQW5pbWF0aW9uRnJhbWUoY29udGV4dC5mcmFtZSk7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBzY3JvbGxzIHdpbmRvdyB3aXRoIGEgc21vb3RoIGJlaGF2aW9yXG5cdCAgICAgKiBAbWV0aG9kIHNtb290aFNjcm9sbFxuXHQgICAgICogQHBhcmFtIHtPYmplY3R8Tm9kZX0gZWxcblx0ICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG5cdCAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBzbW9vdGhTY3JvbGwoZWwsIHgsIHkpIHtcblx0ICAgICAgdmFyIHNjcm9sbGFibGU7XG5cdCAgICAgIHZhciBzdGFydFg7XG5cdCAgICAgIHZhciBzdGFydFk7XG5cdCAgICAgIHZhciBtZXRob2Q7XG5cdCAgICAgIHZhciBzdGFydFRpbWUgPSBub3coKTtcblx0ICAgICAgdmFyIGZyYW1lO1xuXHRcblx0ICAgICAgLy8gZGVmaW5lIHNjcm9sbCBjb250ZXh0XG5cdCAgICAgIGlmIChlbCA9PT0gZC5ib2R5KSB7XG5cdCAgICAgICAgc2Nyb2xsYWJsZSA9IHc7XG5cdCAgICAgICAgc3RhcnRYID0gdy5zY3JvbGxYIHx8IHcucGFnZVhPZmZzZXQ7XG5cdCAgICAgICAgc3RhcnRZID0gdy5zY3JvbGxZIHx8IHcucGFnZVlPZmZzZXQ7XG5cdCAgICAgICAgbWV0aG9kID0gb3JpZ2luYWwuc2Nyb2xsO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHNjcm9sbGFibGUgPSBlbDtcblx0ICAgICAgICBzdGFydFggPSBlbC5zY3JvbGxMZWZ0O1xuXHQgICAgICAgIHN0YXJ0WSA9IGVsLnNjcm9sbFRvcDtcblx0ICAgICAgICBtZXRob2QgPSBzY3JvbGxFbGVtZW50O1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBjYW5jZWwgZnJhbWUgd2hlbiBhIHNjcm9sbCBldmVudCdzIGhhcHBlbmluZ1xuXHQgICAgICBpZiAoZnJhbWUpIHtcblx0ICAgICAgICB3LmNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gc2Nyb2xsIGxvb3Bpbmcgb3ZlciBhIGZyYW1lXG5cdCAgICAgIHN0ZXAoe1xuXHQgICAgICAgIHNjcm9sbGFibGU6IHNjcm9sbGFibGUsXG5cdCAgICAgICAgbWV0aG9kOiBtZXRob2QsXG5cdCAgICAgICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsXG5cdCAgICAgICAgc3RhcnRYOiBzdGFydFgsXG5cdCAgICAgICAgc3RhcnRZOiBzdGFydFksXG5cdCAgICAgICAgeDogeCxcblx0ICAgICAgICB5OiB5LFxuXHQgICAgICAgIGZyYW1lOiBmcmFtZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0XG5cdCAgICAvKlxuXHQgICAgICogT1JJR0lOQUwgTUVUSE9EUyBPVkVSUklERVNcblx0ICAgICAqL1xuXHRcblx0ICAgIC8vIHcuc2Nyb2xsIGFuZCB3LnNjcm9sbFRvXG5cdCAgICB3LnNjcm9sbCA9IHcuc2Nyb2xsVG8gPSBmdW5jdGlvbigpIHtcblx0ICAgICAgLy8gYXZvaWQgc21vb3RoIGJlaGF2aW9yIGlmIG5vdCByZXF1aXJlZFxuXHQgICAgICBpZiAoc2hvdWxkQmFpbE91dChhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgICAgb3JpZ2luYWwuc2Nyb2xsLmNhbGwoXG5cdCAgICAgICAgICB3LFxuXHQgICAgICAgICAgYXJndW1lbnRzWzBdLmxlZnQgfHwgYXJndW1lbnRzWzBdLFxuXHQgICAgICAgICAgYXJndW1lbnRzWzBdLnRvcCB8fCBhcmd1bWVudHNbMV1cblx0ICAgICAgICApO1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gTEVUIFRIRSBTTU9PVEhORVNTIEJFR0lOIVxuXHQgICAgICBzbW9vdGhTY3JvbGwuY2FsbChcblx0ICAgICAgICB3LFxuXHQgICAgICAgIGQuYm9keSxcblx0ICAgICAgICB+fmFyZ3VtZW50c1swXS5sZWZ0LFxuXHQgICAgICAgIH5+YXJndW1lbnRzWzBdLnRvcFxuXHQgICAgICApO1xuXHQgICAgfTtcblx0XG5cdCAgICAvLyB3LnNjcm9sbEJ5XG5cdCAgICB3LnNjcm9sbEJ5ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIC8vIGF2b2lkIHNtb290aCBiZWhhdmlvciBpZiBub3QgcmVxdWlyZWRcblx0ICAgICAgaWYgKHNob3VsZEJhaWxPdXQoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICAgIG9yaWdpbmFsLnNjcm9sbEJ5LmNhbGwoXG5cdCAgICAgICAgICB3LFxuXHQgICAgICAgICAgYXJndW1lbnRzWzBdLmxlZnQgfHwgYXJndW1lbnRzWzBdLFxuXHQgICAgICAgICAgYXJndW1lbnRzWzBdLnRvcCB8fCBhcmd1bWVudHNbMV1cblx0ICAgICAgICApO1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gTEVUIFRIRSBTTU9PVEhORVNTIEJFR0lOIVxuXHQgICAgICBzbW9vdGhTY3JvbGwuY2FsbChcblx0ICAgICAgICB3LFxuXHQgICAgICAgIGQuYm9keSxcblx0ICAgICAgICB+fmFyZ3VtZW50c1swXS5sZWZ0ICsgKHcuc2Nyb2xsWCB8fCB3LnBhZ2VYT2Zmc2V0KSxcblx0ICAgICAgICB+fmFyZ3VtZW50c1swXS50b3AgKyAody5zY3JvbGxZIHx8IHcucGFnZVlPZmZzZXQpXG5cdCAgICAgICk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8vIEVsZW1lbnQucHJvdG90eXBlLnNjcm9sbEludG9WaWV3XG5cdCAgICBFbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAvLyBhdm9pZCBzbW9vdGggYmVoYXZpb3IgaWYgbm90IHJlcXVpcmVkXG5cdCAgICAgIGlmIChzaG91bGRCYWlsT3V0KGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgICBvcmlnaW5hbC5zY3JvbGxJbnRvVmlldy5jYWxsKHRoaXMsIGFyZ3VtZW50c1swXSB8fCB0cnVlKTtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIExFVCBUSEUgU01PT1RITkVTUyBCRUdJTiFcblx0ICAgICAgdmFyIHNjcm9sbGFibGVQYXJlbnQgPSBmaW5kU2Nyb2xsYWJsZVBhcmVudCh0aGlzKTtcblx0ICAgICAgdmFyIHBhcmVudFJlY3RzID0gc2Nyb2xsYWJsZVBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0ICAgICAgdmFyIGNsaWVudFJlY3RzID0gdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XG5cdCAgICAgIGlmIChzY3JvbGxhYmxlUGFyZW50ICE9PSBkLmJvZHkpIHtcblx0ICAgICAgICAvLyByZXZlYWwgZWxlbWVudCBpbnNpZGUgcGFyZW50XG5cdCAgICAgICAgc21vb3RoU2Nyb2xsLmNhbGwoXG5cdCAgICAgICAgICB0aGlzLFxuXHQgICAgICAgICAgc2Nyb2xsYWJsZVBhcmVudCxcblx0ICAgICAgICAgIHNjcm9sbGFibGVQYXJlbnQuc2Nyb2xsTGVmdCArIGNsaWVudFJlY3RzLmxlZnQgLSBwYXJlbnRSZWN0cy5sZWZ0LFxuXHQgICAgICAgICAgc2Nyb2xsYWJsZVBhcmVudC5zY3JvbGxUb3AgKyBjbGllbnRSZWN0cy50b3AgLSBwYXJlbnRSZWN0cy50b3Bcblx0ICAgICAgICApO1xuXHQgICAgICAgIC8vIHJldmVhbCBwYXJlbnQgaW4gdmlld3BvcnRcblx0ICAgICAgICB3LnNjcm9sbEJ5KHtcblx0ICAgICAgICAgIGxlZnQ6IHBhcmVudFJlY3RzLmxlZnQsXG5cdCAgICAgICAgICB0b3A6IHBhcmVudFJlY3RzLnRvcCxcblx0ICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJ1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIC8vIHJldmVhbCBlbGVtZW50IGluIHZpZXdwb3J0XG5cdCAgICAgICAgdy5zY3JvbGxCeSh7XG5cdCAgICAgICAgICBsZWZ0OiBjbGllbnRSZWN0cy5sZWZ0LFxuXHQgICAgICAgICAgdG9wOiBjbGllbnRSZWN0cy50b3AsXG5cdCAgICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCdcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIGlmICh0cnVlKSB7XG5cdCAgICAvLyBjb21tb25qc1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSB7IHBvbHlmaWxsOiBwb2x5ZmlsbCB9O1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBnbG9iYWxcblx0ICAgIHBvbHlmaWxsKCk7XG5cdCAgfVxuXHR9KSh3aW5kb3csIGRvY3VtZW50KTtcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbWFpbi5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAxYzdkZjQ2ODU2MWI0NTM1ZGQ4NyIsInJlcXVpcmUoJ3Ntb290aHNjcm9sbC1wb2x5ZmlsbCcpLnBvbHlmaWxsKCk7XG5cbi8vIHNtb290aCBzY3JvbGxpbmdcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGU9PntcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgJHRvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlLmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJykpO1xuICAgICR0by5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbn0pO1xuXG4vLyBwbGF5IHZpZGVvXG5jb25zdCB2ZHMgPSBbJ2RldmVsb3BtZW50JywgJ291dHNvdXJjaW5nJywgJ2NvbnNhbHRpbmcnLCAndGVzdGluZycsICdhdXRvbWF0aW9uJ107XG5sZXQgJHZpZGVvcyA9IHZkcy5yZWR1Y2UoKHAsaSkgPT4ge3BbYCR7aX1gXSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2l9IHZpZGVvYCk7IHJldHVybiBwO30sIHt9KTtcbnZkcy5tYXAoZT0+e1xuICAgIGNvbnN0ICRlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2V9YCk7XG4gICAgJGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcbiAgICAgICAgJHZpZGVvc1tgJHtlfWBdLnBsYXkoKTtcbiAgICB9KTtcblxuICAgICRlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcbiAgICAgICAgJHZpZGVvc1tgJHtlfWBdLnBhdXNlKCk7XG4gICAgfSk7XG4gICAgdHJ5e1xuICAgICAgICAkdmlkZW9zW2Ake2V9YF0ucGxheSgpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpPT4kdmlkZW9zW2Ake2V9YF0ucGF1c2UoKSwxMDAwKTtcbiAgICB9Y2F0Y2goZSl7fVxufSk7XG5cbi8vIGZvcm1cbmNvbnN0ICRmb3JtID0gZG9jdW1lbnQuZm9ybXNbMF07XG5bLi4uJGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmZpJyldLm1hcChpPT57XG4gICAgaS52YWx1ZSA9IFwiXCI7XG4gICAgcmVtb3ZlQ2xhc3MoaSwgJ2hhcy10ZXh0Jyk7XG4gICAgaS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+e1xuICAgICAgICBjb25zdCAkZWwgPSBlLmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgIGlmICgkZWwudmFsdWUgPT09ICcnKXtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKCRlbCwgJ2hhcy10ZXh0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGFkZENsYXNzKCRlbCwgJ2hhcy10ZXh0Jyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG4vLyBuYXZpZ2F0aW9uIGJ1dHRvblxuXG5sZXQgbWVudSA9IG51bGw7XG5jb25zdCAkbV9uYXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbS1uYXYnKTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZT0+e1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoIW1lbnUpe1xuICAgICAgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ25hdiB1bCcpO1xuICAgICAgJG1fbmF2LmFwcGVuZENoaWxkKG1lbnUuY2xvbmVOb2RlKHRydWUpKTtcbiAgICB9XG4gICAgYWRkQ2xhc3MoZG9jdW1lbnQuYm9keSwgXCJtb2JpbGUtbWVudVwiKTtcbn0pO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlLW0tbmF2JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlPT57XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHJlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksIFwibW9iaWxlLW1lbnVcIik7XG59KTtcblxuaWYgKHdpbmRvdy5Qcm9taXNlKSB7XG4gIGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCRmb3JtKTtcbiAgZGF0YS5hcHBlbmQoJ2FqYXgnLCd0cnVlJyk7XG4gICRmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGUgPT57XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGFkZENsYXNzKCRmb3JtLCdibG9ja2VkJyk7XG4gICAgZmV0Y2goJGZvcm0uYWN0aW9uLCB7XG4gICAgICAvKm1ldGhvZDogJ1BPU1QnLFxuICAgICAgYm9keTogZGF0YSovXG4gICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGFkZENsYXNzKCRmb3JtLCdzZW5kZWQnKTtcbiAgICAgICAgY29uc3QgJHNlbmRPayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBhZGRDbGFzcygkc2VuZE9rLCAnc2VuZC1vaycpO1xuICAgICAgICAkc2VuZE9rLmlubmVySFRNTCA9ICfQodC/0LDRgdC40LHQviEg0JzRiyDQstCw0Lwg0YHQutC+0YDQviDQv9C10YDQtdC30LLQvtC90LjQvC48YnI+0JXRidC1INCy0Ysg0LzQvtC20LXRgtC1INC90LDQv9C40YHQsNGC0Ywg0L3QsNC8INC90LAgPGEgaHJlZj1cIm1haWx0bzppbmZvQGxpbmtvcm4ucnVcIj5pbmZvQGxpbmtvcm4ucnU8L2E+JztcbiAgICAgICAgJGZvcm0uYXBwZW5kQ2hpbGQoJHNlbmRPayk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZW5kLW9rJykuZm9jdXMoKTtcbiAgICB9KS5jYXRjaChyZW1vdmVDbGFzcygkZm9ybSwnYmxvY2tlZCcpKTtcbiAgfSk7XG59XG5cbi8vYWRkIGNsYXNzXG5mdW5jdGlvbiBhZGRDbGFzcyhlbCwgY2xhc3NOYW1lKXtcbmlmIChlbC5jbGFzc0xpc3QpXG4gIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbmVsc2VcbiAgZWwuY2xhc3NOYW1lICs9ICcgJyArIGNsYXNzTmFtZTtcbn1cbi8vIHJlbW92ZSBjbGFzc1xuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSl7XG5cbmlmIChlbC5jbGFzc0xpc3QpXG4gIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbmVsc2VcbiAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgnKF58XFxcXGIpJyArIGNsYXNzTmFtZS5zcGxpdCgnICcpLmpvaW4oJ3wnKSArICcoXFxcXGJ8JCknLCAnZ2knKSwgJyAnKTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL0Y6L3Byb2plY3RzL2xpbmtvcm4yMDE3L3NyYy9qcy9tYWluLmpzIiwiLypcbiAqIHNtb290aHNjcm9sbCBwb2x5ZmlsbCAtIHYwLjMuNFxuICogaHR0cHM6Ly9pYW1kdXN0YW4uZ2l0aHViLmlvL3Ntb290aHNjcm9sbFxuICogMjAxNiAoYykgRHVzdGFuIEthc3RlbiwgSmVyZW1pYXMgTWVuaWNoZWxsaSAtIE1JVCBMaWNlbnNlXG4gKi9cblxuKGZ1bmN0aW9uKHcsIGQsIHVuZGVmaW5lZCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLypcbiAgICogYWxpYXNlc1xuICAgKiB3OiB3aW5kb3cgZ2xvYmFsIG9iamVjdFxuICAgKiBkOiBkb2N1bWVudFxuICAgKiB1bmRlZmluZWQ6IHVuZGVmaW5lZFxuICAgKi9cblxuICAvLyBwb2x5ZmlsbFxuICBmdW5jdGlvbiBwb2x5ZmlsbCgpIHtcbiAgICAvLyByZXR1cm4gd2hlbiBzY3JvbGxCZWhhdmlvciBpbnRlcmZhY2UgaXMgc3VwcG9ydGVkXG4gICAgaWYgKCdzY3JvbGxCZWhhdmlvcicgaW4gZC5kb2N1bWVudEVsZW1lbnQuc3R5bGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIGdsb2JhbHNcbiAgICAgKi9cbiAgICB2YXIgRWxlbWVudCA9IHcuSFRNTEVsZW1lbnQgfHwgdy5FbGVtZW50O1xuICAgIHZhciBTQ1JPTExfVElNRSA9IDQ2ODtcblxuICAgIC8qXG4gICAgICogb2JqZWN0IGdhdGhlcmluZyBvcmlnaW5hbCBzY3JvbGwgbWV0aG9kc1xuICAgICAqL1xuICAgIHZhciBvcmlnaW5hbCA9IHtcbiAgICAgIHNjcm9sbDogdy5zY3JvbGwgfHwgdy5zY3JvbGxUbyxcbiAgICAgIHNjcm9sbEJ5OiB3LnNjcm9sbEJ5LFxuICAgICAgc2Nyb2xsSW50b1ZpZXc6IEVsZW1lbnQucHJvdG90eXBlLnNjcm9sbEludG9WaWV3XG4gICAgfTtcblxuICAgIC8qXG4gICAgICogZGVmaW5lIHRpbWluZyBtZXRob2RcbiAgICAgKi9cbiAgICB2YXIgbm93ID0gdy5wZXJmb3JtYW5jZSAmJiB3LnBlcmZvcm1hbmNlLm5vd1xuICAgICAgPyB3LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHcucGVyZm9ybWFuY2UpIDogRGF0ZS5ub3c7XG5cbiAgICAvKipcbiAgICAgKiBjaGFuZ2VzIHNjcm9sbCBwb3NpdGlvbiBpbnNpZGUgYW4gZWxlbWVudFxuICAgICAqIEBtZXRob2Qgc2Nyb2xsRWxlbWVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzY3JvbGxFbGVtZW50KHgsIHkpIHtcbiAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHg7XG4gICAgICB0aGlzLnNjcm9sbFRvcCA9IHk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyByZXN1bHQgb2YgYXBwbHlpbmcgZWFzZSBtYXRoIGZ1bmN0aW9uIHRvIGEgbnVtYmVyXG4gICAgICogQG1ldGhvZCBlYXNlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGtcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVhc2Uoaykge1xuICAgICAgcmV0dXJuIDAuNSAqICgxIC0gTWF0aC5jb3MoTWF0aC5QSSAqIGspKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBpbmRpY2F0ZXMgaWYgYSBzbW9vdGggYmVoYXZpb3Igc2hvdWxkIGJlIGFwcGxpZWRcbiAgICAgKiBAbWV0aG9kIHNob3VsZEJhaWxPdXRcbiAgICAgKiBAcGFyYW0ge051bWJlcnxPYmplY3R9IHhcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaG91bGRCYWlsT3V0KHgpIHtcbiAgICAgIGlmICh0eXBlb2YgeCAhPT0gJ29iamVjdCdcbiAgICAgICAgICAgIHx8IHggPT09IG51bGxcbiAgICAgICAgICAgIHx8IHguYmVoYXZpb3IgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgfHwgeC5iZWhhdmlvciA9PT0gJ2F1dG8nXG4gICAgICAgICAgICB8fCB4LmJlaGF2aW9yID09PSAnaW5zdGFudCcpIHtcbiAgICAgICAgLy8gZmlyc3QgYXJnIG5vdCBhbiBvYmplY3QvbnVsbFxuICAgICAgICAvLyBvciBiZWhhdmlvciBpcyBhdXRvLCBpbnN0YW50IG9yIHVuZGVmaW5lZFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiB4ID09PSAnb2JqZWN0J1xuICAgICAgICAgICAgJiYgeC5iZWhhdmlvciA9PT0gJ3Ntb290aCcpIHtcbiAgICAgICAgLy8gZmlyc3QgYXJndW1lbnQgaXMgYW4gb2JqZWN0IGFuZCBiZWhhdmlvciBpcyBzbW9vdGhcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyB0aHJvdyBlcnJvciB3aGVuIGJlaGF2aW9yIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2JlaGF2aW9yIG5vdCB2YWxpZCcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGZpbmRzIHNjcm9sbGFibGUgcGFyZW50IG9mIGFuIGVsZW1lbnRcbiAgICAgKiBAbWV0aG9kIGZpbmRTY3JvbGxhYmxlUGFyZW50XG4gICAgICogQHBhcmFtIHtOb2RlfSBlbFxuICAgICAqIEByZXR1cm5zIHtOb2RlfSBlbFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpbmRTY3JvbGxhYmxlUGFyZW50KGVsKSB7XG4gICAgICB2YXIgaXNCb2R5O1xuICAgICAgdmFyIGhhc1Njcm9sbGFibGVTcGFjZTtcbiAgICAgIHZhciBoYXNWaXNpYmxlT3ZlcmZsb3c7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgZWwgPSBlbC5wYXJlbnROb2RlO1xuXG4gICAgICAgIC8vIHNldCBjb25kaXRpb24gdmFyaWFibGVzXG4gICAgICAgIGlzQm9keSA9IGVsID09PSBkLmJvZHk7XG4gICAgICAgIGhhc1Njcm9sbGFibGVTcGFjZSA9XG4gICAgICAgICAgZWwuY2xpZW50SGVpZ2h0IDwgZWwuc2Nyb2xsSGVpZ2h0IHx8XG4gICAgICAgICAgZWwuY2xpZW50V2lkdGggPCBlbC5zY3JvbGxXaWR0aDtcbiAgICAgICAgaGFzVmlzaWJsZU92ZXJmbG93ID1cbiAgICAgICAgICB3LmdldENvbXB1dGVkU3R5bGUoZWwsIG51bGwpLm92ZXJmbG93ID09PSAndmlzaWJsZSc7XG4gICAgICB9IHdoaWxlICghaXNCb2R5ICYmICEoaGFzU2Nyb2xsYWJsZVNwYWNlICYmICFoYXNWaXNpYmxlT3ZlcmZsb3cpKTtcblxuICAgICAgaXNCb2R5ID0gaGFzU2Nyb2xsYWJsZVNwYWNlID0gaGFzVmlzaWJsZU92ZXJmbG93ID0gbnVsbDtcblxuICAgICAgcmV0dXJuIGVsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNlbGYgaW52b2tlZCBmdW5jdGlvbiB0aGF0LCBnaXZlbiBhIGNvbnRleHQsIHN0ZXBzIHRocm91Z2ggc2Nyb2xsaW5nXG4gICAgICogQG1ldGhvZCBzdGVwXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdGVwKGNvbnRleHQpIHtcbiAgICAgIC8vIGNhbGwgbWV0aG9kIGFnYWluIG9uIG5leHQgYXZhaWxhYmxlIGZyYW1lXG4gICAgICBjb250ZXh0LmZyYW1lID0gdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RlcC5iaW5kKHcsIGNvbnRleHQpKTtcblxuICAgICAgdmFyIHRpbWUgPSBub3coKTtcbiAgICAgIHZhciB2YWx1ZTtcbiAgICAgIHZhciBjdXJyZW50WDtcbiAgICAgIHZhciBjdXJyZW50WTtcbiAgICAgIHZhciBlbGFwc2VkID0gKHRpbWUgLSBjb250ZXh0LnN0YXJ0VGltZSkgLyBTQ1JPTExfVElNRTtcblxuICAgICAgLy8gYXZvaWQgZWxhcHNlZCB0aW1lcyBoaWdoZXIgdGhhbiBvbmVcbiAgICAgIGVsYXBzZWQgPSBlbGFwc2VkID4gMSA/IDEgOiBlbGFwc2VkO1xuXG4gICAgICAvLyBhcHBseSBlYXNpbmcgdG8gZWxhcHNlZCB0aW1lXG4gICAgICB2YWx1ZSA9IGVhc2UoZWxhcHNlZCk7XG5cbiAgICAgIGN1cnJlbnRYID0gY29udGV4dC5zdGFydFggKyAoY29udGV4dC54IC0gY29udGV4dC5zdGFydFgpICogdmFsdWU7XG4gICAgICBjdXJyZW50WSA9IGNvbnRleHQuc3RhcnRZICsgKGNvbnRleHQueSAtIGNvbnRleHQuc3RhcnRZKSAqIHZhbHVlO1xuXG4gICAgICBjb250ZXh0Lm1ldGhvZC5jYWxsKGNvbnRleHQuc2Nyb2xsYWJsZSwgY3VycmVudFgsIGN1cnJlbnRZKTtcblxuICAgICAgLy8gcmV0dXJuIHdoZW4gZW5kIHBvaW50cyBoYXZlIGJlZW4gcmVhY2hlZFxuICAgICAgaWYgKGN1cnJlbnRYID09PSBjb250ZXh0LnggJiYgY3VycmVudFkgPT09IGNvbnRleHQueSkge1xuICAgICAgICB3LmNhbmNlbEFuaW1hdGlvbkZyYW1lKGNvbnRleHQuZnJhbWUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc2Nyb2xscyB3aW5kb3cgd2l0aCBhIHNtb290aCBiZWhhdmlvclxuICAgICAqIEBtZXRob2Qgc21vb3RoU2Nyb2xsXG4gICAgICogQHBhcmFtIHtPYmplY3R8Tm9kZX0gZWxcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICovXG4gICAgZnVuY3Rpb24gc21vb3RoU2Nyb2xsKGVsLCB4LCB5KSB7XG4gICAgICB2YXIgc2Nyb2xsYWJsZTtcbiAgICAgIHZhciBzdGFydFg7XG4gICAgICB2YXIgc3RhcnRZO1xuICAgICAgdmFyIG1ldGhvZDtcbiAgICAgIHZhciBzdGFydFRpbWUgPSBub3coKTtcbiAgICAgIHZhciBmcmFtZTtcblxuICAgICAgLy8gZGVmaW5lIHNjcm9sbCBjb250ZXh0XG4gICAgICBpZiAoZWwgPT09IGQuYm9keSkge1xuICAgICAgICBzY3JvbGxhYmxlID0gdztcbiAgICAgICAgc3RhcnRYID0gdy5zY3JvbGxYIHx8IHcucGFnZVhPZmZzZXQ7XG4gICAgICAgIHN0YXJ0WSA9IHcuc2Nyb2xsWSB8fCB3LnBhZ2VZT2Zmc2V0O1xuICAgICAgICBtZXRob2QgPSBvcmlnaW5hbC5zY3JvbGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzY3JvbGxhYmxlID0gZWw7XG4gICAgICAgIHN0YXJ0WCA9IGVsLnNjcm9sbExlZnQ7XG4gICAgICAgIHN0YXJ0WSA9IGVsLnNjcm9sbFRvcDtcbiAgICAgICAgbWV0aG9kID0gc2Nyb2xsRWxlbWVudDtcbiAgICAgIH1cblxuICAgICAgLy8gY2FuY2VsIGZyYW1lIHdoZW4gYSBzY3JvbGwgZXZlbnQncyBoYXBwZW5pbmdcbiAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICB3LmNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lKTtcbiAgICAgIH1cblxuICAgICAgLy8gc2Nyb2xsIGxvb3Bpbmcgb3ZlciBhIGZyYW1lXG4gICAgICBzdGVwKHtcbiAgICAgICAgc2Nyb2xsYWJsZTogc2Nyb2xsYWJsZSxcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLFxuICAgICAgICBzdGFydFg6IHN0YXJ0WCxcbiAgICAgICAgc3RhcnRZOiBzdGFydFksXG4gICAgICAgIHg6IHgsXG4gICAgICAgIHk6IHksXG4gICAgICAgIGZyYW1lOiBmcmFtZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBPUklHSU5BTCBNRVRIT0RTIE9WRVJSSURFU1xuICAgICAqL1xuXG4gICAgLy8gdy5zY3JvbGwgYW5kIHcuc2Nyb2xsVG9cbiAgICB3LnNjcm9sbCA9IHcuc2Nyb2xsVG8gPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGF2b2lkIHNtb290aCBiZWhhdmlvciBpZiBub3QgcmVxdWlyZWRcbiAgICAgIGlmIChzaG91bGRCYWlsT3V0KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgb3JpZ2luYWwuc2Nyb2xsLmNhbGwoXG4gICAgICAgICAgdyxcbiAgICAgICAgICBhcmd1bWVudHNbMF0ubGVmdCB8fCBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgYXJndW1lbnRzWzBdLnRvcCB8fCBhcmd1bWVudHNbMV1cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBMRVQgVEhFIFNNT09USE5FU1MgQkVHSU4hXG4gICAgICBzbW9vdGhTY3JvbGwuY2FsbChcbiAgICAgICAgdyxcbiAgICAgICAgZC5ib2R5LFxuICAgICAgICB+fmFyZ3VtZW50c1swXS5sZWZ0LFxuICAgICAgICB+fmFyZ3VtZW50c1swXS50b3BcbiAgICAgICk7XG4gICAgfTtcblxuICAgIC8vIHcuc2Nyb2xsQnlcbiAgICB3LnNjcm9sbEJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBhdm9pZCBzbW9vdGggYmVoYXZpb3IgaWYgbm90IHJlcXVpcmVkXG4gICAgICBpZiAoc2hvdWxkQmFpbE91dChhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgIG9yaWdpbmFsLnNjcm9sbEJ5LmNhbGwoXG4gICAgICAgICAgdyxcbiAgICAgICAgICBhcmd1bWVudHNbMF0ubGVmdCB8fCBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgYXJndW1lbnRzWzBdLnRvcCB8fCBhcmd1bWVudHNbMV1cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBMRVQgVEhFIFNNT09USE5FU1MgQkVHSU4hXG4gICAgICBzbW9vdGhTY3JvbGwuY2FsbChcbiAgICAgICAgdyxcbiAgICAgICAgZC5ib2R5LFxuICAgICAgICB+fmFyZ3VtZW50c1swXS5sZWZ0ICsgKHcuc2Nyb2xsWCB8fCB3LnBhZ2VYT2Zmc2V0KSxcbiAgICAgICAgfn5hcmd1bWVudHNbMF0udG9wICsgKHcuc2Nyb2xsWSB8fCB3LnBhZ2VZT2Zmc2V0KVxuICAgICAgKTtcbiAgICB9O1xuXG4gICAgLy8gRWxlbWVudC5wcm90b3R5cGUuc2Nyb2xsSW50b1ZpZXdcbiAgICBFbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldyA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gYXZvaWQgc21vb3RoIGJlaGF2aW9yIGlmIG5vdCByZXF1aXJlZFxuICAgICAgaWYgKHNob3VsZEJhaWxPdXQoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICBvcmlnaW5hbC5zY3JvbGxJbnRvVmlldy5jYWxsKHRoaXMsIGFyZ3VtZW50c1swXSB8fCB0cnVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBMRVQgVEhFIFNNT09USE5FU1MgQkVHSU4hXG4gICAgICB2YXIgc2Nyb2xsYWJsZVBhcmVudCA9IGZpbmRTY3JvbGxhYmxlUGFyZW50KHRoaXMpO1xuICAgICAgdmFyIHBhcmVudFJlY3RzID0gc2Nyb2xsYWJsZVBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBjbGllbnRSZWN0cyA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgIGlmIChzY3JvbGxhYmxlUGFyZW50ICE9PSBkLmJvZHkpIHtcbiAgICAgICAgLy8gcmV2ZWFsIGVsZW1lbnQgaW5zaWRlIHBhcmVudFxuICAgICAgICBzbW9vdGhTY3JvbGwuY2FsbChcbiAgICAgICAgICB0aGlzLFxuICAgICAgICAgIHNjcm9sbGFibGVQYXJlbnQsXG4gICAgICAgICAgc2Nyb2xsYWJsZVBhcmVudC5zY3JvbGxMZWZ0ICsgY2xpZW50UmVjdHMubGVmdCAtIHBhcmVudFJlY3RzLmxlZnQsXG4gICAgICAgICAgc2Nyb2xsYWJsZVBhcmVudC5zY3JvbGxUb3AgKyBjbGllbnRSZWN0cy50b3AgLSBwYXJlbnRSZWN0cy50b3BcbiAgICAgICAgKTtcbiAgICAgICAgLy8gcmV2ZWFsIHBhcmVudCBpbiB2aWV3cG9ydFxuICAgICAgICB3LnNjcm9sbEJ5KHtcbiAgICAgICAgICBsZWZ0OiBwYXJlbnRSZWN0cy5sZWZ0LFxuICAgICAgICAgIHRvcDogcGFyZW50UmVjdHMudG9wLFxuICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJ1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHJldmVhbCBlbGVtZW50IGluIHZpZXdwb3J0XG4gICAgICAgIHcuc2Nyb2xsQnkoe1xuICAgICAgICAgIGxlZnQ6IGNsaWVudFJlY3RzLmxlZnQsXG4gICAgICAgICAgdG9wOiBjbGllbnRSZWN0cy50b3AsXG4gICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgLy8gY29tbW9uanNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHsgcG9seWZpbGw6IHBvbHlmaWxsIH07XG4gIH0gZWxzZSB7XG4gICAgLy8gZ2xvYmFsXG4gICAgcG9seWZpbGwoKTtcbiAgfVxufSkod2luZG93LCBkb2N1bWVudCk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc21vb3Roc2Nyb2xsLXBvbHlmaWxsL2Rpc3Qvc21vb3Roc2Nyb2xsLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=